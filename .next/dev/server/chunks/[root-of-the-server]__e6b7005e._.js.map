{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///E:/React%20Projects/NEXTJS%20PROJECTS/OZONE/ozone-water-1/lib/db.js"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nconst connectionDb = async () => {\r\n  if (mongoose.connections[0].readyState) {\r\n    console.log(\"MongoDB already connected\");\r\n    return;\r\n  }\r\n\r\n  try {\r\n    await mongoose.connect(process.env.MONGO_URI); \r\n    console.log(\"MongoDB connected successfully\");\r\n  } catch (err) {\r\n    console.error(\"MongoDB connection failed:\", err);\r\n    throw err;\r\n  }\r\n};\r\n\r\nexport default connectionDb;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,eAAe;IACnB,IAAI,oHAAQ,CAAC,WAAW,CAAC,EAAE,CAAC,UAAU,EAAE;QACtC,QAAQ,GAAG,CAAC;QACZ;IACF;IAEA,IAAI;QACF,MAAM,oHAAQ,CAAC,OAAO,CAAC,QAAQ,GAAG,CAAC,SAAS;QAC5C,QAAQ,GAAG,CAAC;IACd,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,MAAM;IACR;AACF;uCAEe"}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///E:/React%20Projects/NEXTJS%20PROJECTS/OZONE/ozone-water-1/models/Order.js"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nconst orderItemSchema = new mongoose.Schema(\r\n  {\r\n    size: {\r\n      type: String,\r\n      required: true,\r\n      trim: true,\r\n    },\r\n    price: {\r\n      type: Number,\r\n      required: true,\r\n      min: 0,\r\n    },\r\n    quantity: {\r\n      type: Number,\r\n      required: true,\r\n      min: 1,\r\n    },\r\n  },\r\n  { _id: false }\r\n);\r\n\r\nconst orderSchema = new mongoose.Schema(\r\n  {\r\n    shopName: {\r\n      type: String,\r\n      required: true,\r\n      trim: true,\r\n    },\r\n\r\n    shopAddress: {\r\n      type: String,\r\n      required: true,\r\n      trim: true,\r\n    },\r\n\r\n    shopContact: {\r\n      type: String,\r\n      required: true,\r\n      trim: true,\r\n    },\r\n\r\n    orderItems: {\r\n      type: [orderItemSchema], // â¬… MULTIPLE ITEMS HERE\r\n      required: true,\r\n      validate: {\r\n        validator: (items) => items.length > 0,\r\n        message: \"Order must include at least 1 item.\",\r\n      },\r\n    },\r\n\r\n    totalPrice: {\r\n      type: Number,\r\n      required: true,\r\n      min: 0,\r\n    },\r\n\r\n    paymentStatus: {\r\n      type: String,\r\n      enum: [\"unpaid\", \"paid\", \"partially-paid\"],\r\n      default: \"unpaid\",\r\n    },\r\n    paidAmount: {\r\n      type: Number,\r\n      min: 0,\r\n        default: 0,\r\n    },\r\n\r\n    remainingAmount: {\r\n      type: Number,\r\n      min: 0,\r\n      default: 0,\r\n      validate: {\r\n        validator: function (value) {\r\n          if (this.paymentStatus === \"partially-paid\") {\r\n            return value > 0;\r\n          }\r\n          return true;\r\n        },\r\n        message:\r\n          \"Remaining amount must be greater than 0 when status is partially-paid.\",\r\n      },\r\n    },\r\n\r\n    status: {\r\n      type: String,\r\n      enum: [\"pending\", \"in-transit\", \"completed\", \"canceled\"],\r\n      default: \"pending\",\r\n    },\r\n  },\r\n  { timestamps: true }\r\n);\r\n\r\nexport default mongoose.model(\"Order\", orderSchema);\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB,IAAI,oHAAQ,CAAC,MAAM,CACzC;IACE,MAAM;QACJ,MAAM;QACN,UAAU;QACV,MAAM;IACR;IACA,OAAO;QACL,MAAM;QACN,UAAU;QACV,KAAK;IACP;IACA,UAAU;QACR,MAAM;QACN,UAAU;QACV,KAAK;IACP;AACF,GACA;IAAE,KAAK;AAAM;AAGf,MAAM,cAAc,IAAI,oHAAQ,CAAC,MAAM,CACrC;IACE,UAAU;QACR,MAAM;QACN,UAAU;QACV,MAAM;IACR;IAEA,aAAa;QACX,MAAM;QACN,UAAU;QACV,MAAM;IACR;IAEA,aAAa;QACX,MAAM;QACN,UAAU;QACV,MAAM;IACR;IAEA,YAAY;QACV,MAAM;YAAC;SAAgB;QACvB,UAAU;QACV,UAAU;YACR,WAAW,CAAC,QAAU,MAAM,MAAM,GAAG;YACrC,SAAS;QACX;IACF;IAEA,YAAY;QACV,MAAM;QACN,UAAU;QACV,KAAK;IACP;IAEA,eAAe;QACb,MAAM;QACN,MAAM;YAAC;YAAU;YAAQ;SAAiB;QAC1C,SAAS;IACX;IACA,YAAY;QACV,MAAM;QACN,KAAK;QACH,SAAS;IACb;IAEA,iBAAiB;QACf,MAAM;QACN,KAAK;QACL,SAAS;QACT,UAAU;YACR,WAAW,SAAU,KAAK;gBACxB,IAAI,IAAI,CAAC,aAAa,KAAK,kBAAkB;oBAC3C,OAAO,QAAQ;gBACjB;gBACA,OAAO;YACT;YACA,SACE;QACJ;IACF;IAEA,QAAQ;QACN,MAAM;QACN,MAAM;YAAC;YAAW;YAAc;YAAa;SAAW;QACxD,SAAS;IACX;AACF,GACA;IAAE,YAAY;AAAK;uCAGN,oHAAQ,CAAC,KAAK,CAAC,SAAS"}},
    {"offset": {"line": 178, "column": 0}, "map": {"version":3,"sources":["file:///E:/React%20Projects/NEXTJS%20PROJECTS/OZONE/ozone-water-1/src/app/api/orders/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport connectDB from \"../../../../lib/db\";\r\nimport Order from \"../../../../models/Order\";\r\n\r\nexport async function POST(request) {\r\n  try {\r\n    await connectDB();\r\n\r\n    const {\r\n      shopName,\r\n      shopAddress,\r\n      shopContact,\r\n      orderItems, \r\n        paidAmount,\r\n      totalPrice,\r\n      paymentStatus,\r\n      remainingAmount,\r\n      status,\r\n    } = await request.json();\r\n\r\n\r\n    if (!shopName || !shopAddress || !shopContact ) {\r\n      return NextResponse.json(\r\n        { message: \"Shop details are required\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    if (!Array.isArray(orderItems) || orderItems.length === 0) {\r\n      return NextResponse.json(\r\n        { message: \"Order must contain at least 1 item\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Validate each item\r\n    for (let item of orderItems) {\r\n      if (!item.size || !item.price || !item.quantity ) {\r\n        return NextResponse.json(\r\n          { message: \"Each order item must include size, price, and quantity\" },\r\n          { status: 400 }\r\n        );\r\n      }\r\n    }\r\n\r\n    if (totalPrice === undefined) {\r\n      return NextResponse.json(\r\n        { message: \"totalPrice is required\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const newOrder = new Order({\r\n      shopName,\r\n      shopAddress,\r\n      shopContact,\r\n      orderItems,\r\n      totalPrice,\r\n      paidAmount,\r\n      paymentStatus,\r\n      remainingAmount,\r\n      status,\r\n    });\r\n\r\n    await newOrder.save();\r\n\r\n    return NextResponse.json(\r\n      { message: \"Order placed successfully\", order: newOrder },\r\n      { status: 201 }\r\n    );\r\n  } catch (error) {\r\n    console.error(\"Order creation error:\", error);\r\n    return NextResponse.json(\r\n      { message: \"Server error\", error: error.message },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\nexport async function GET(request) {\r\n  try {\r\n    await connectDB();\r\n    const orders = await Order.find().sort({ createdAt: -1 });  \r\n    return NextResponse.json({ success : true, message: \"Orders fetched successfully\", data:orders }, { status: 200 });\r\n  } catch (error) {\r\n    console.error(\"Error fetching orders:\", error);\r\n    return NextResponse.json(\r\n      { message: \"Server error\", error: error.message },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\nexport async function PUT(request) {\r\n  try {\r\n    await connectDB();\r\n    const { orderId, updateData } = await request.json();\r\n    const updatedOrder = await Order.findByIdAndUpdate(\r\n      orderId,\r\n      { $set: updateData },\r\n      { new: true }\r\n    );\r\n    if (!updatedOrder) {\r\n      return NextResponse.json(\r\n        { message: \"Order not found\" },\r\n        { status: 404 }\r\n      );\r\n    }\r\n    return NextResponse.json(\r\n      { message: \"Order updated successfully\", order: updatedOrder , success: true},\r\n      { status: 200 }\r\n    );\r\n  } catch (error) {\r\n    console.error(\"Error updating order:\", error);\r\n    return NextResponse.json(\r\n      { message: \"Server error\", error: error.message },\r\n      { status: 500 }\r\n    );\r\n  } \r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,OAAO;IAChC,IAAI;QACF,MAAM,IAAA,sJAAS;QAEf,MAAM,EACJ,QAAQ,EACR,WAAW,EACX,WAAW,EACX,UAAU,EACR,UAAU,EACZ,UAAU,EACV,aAAa,EACb,eAAe,EACf,MAAM,EACP,GAAG,MAAM,QAAQ,IAAI;QAGtB,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,aAAc;YAC9C,OAAO,gLAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;YAA4B,GACvC;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI,CAAC,MAAM,OAAO,CAAC,eAAe,WAAW,MAAM,KAAK,GAAG;YACzD,OAAO,gLAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;YAAqC,GAChD;gBAAE,QAAQ;YAAI;QAElB;QAEA,qBAAqB;QACrB,KAAK,IAAI,QAAQ,WAAY;YAC3B,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,CAAC,KAAK,QAAQ,EAAG;gBAChD,OAAO,gLAAY,CAAC,IAAI,CACtB;oBAAE,SAAS;gBAAyD,GACpE;oBAAE,QAAQ;gBAAI;YAElB;QACF;QAEA,IAAI,eAAe,WAAW;YAC5B,OAAO,gLAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;YAAyB,GACpC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,WAAW,IAAI,4JAAK,CAAC;YACzB;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;QACF;QAEA,MAAM,SAAS,IAAI;QAEnB,OAAO,gLAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAA6B,OAAO;QAAS,GACxD;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gLAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAgB,OAAO,MAAM,OAAO;QAAC,GAChD;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,eAAe,IAAI,OAAO;IAC/B,IAAI;QACF,MAAM,IAAA,sJAAS;QACf,MAAM,SAAS,MAAM,4JAAK,CAAC,IAAI,GAAG,IAAI,CAAC;YAAE,WAAW,CAAC;QAAE;QACvD,OAAO,gLAAY,CAAC,IAAI,CAAC;YAAE,SAAU;YAAM,SAAS;YAA+B,MAAK;QAAO,GAAG;YAAE,QAAQ;QAAI;IAClH,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gLAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAgB,OAAO,MAAM,OAAO;QAAC,GAChD;YAAE,QAAQ;QAAI;IAElB;AACF;AACO,eAAe,IAAI,OAAO;IAC/B,IAAI;QACF,MAAM,IAAA,sJAAS;QACf,MAAM,EAAE,OAAO,EAAE,UAAU,EAAE,GAAG,MAAM,QAAQ,IAAI;QAClD,MAAM,eAAe,MAAM,4JAAK,CAAC,iBAAiB,CAChD,SACA;YAAE,MAAM;QAAW,GACnB;YAAE,KAAK;QAAK;QAEd,IAAI,CAAC,cAAc;YACjB,OAAO,gLAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;YAAkB,GAC7B;gBAAE,QAAQ;YAAI;QAElB;QACA,OAAO,gLAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAA8B,OAAO;YAAe,SAAS;QAAI,GAC5E;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gLAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAgB,OAAO,MAAM,OAAO;QAAC,GAChD;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}