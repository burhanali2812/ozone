{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///E:/React%20Projects/NEXTJS%20PROJECTS/OZONE/ozone-water-1/lib/db.js"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nconst connectionDb = async () => {\r\n  if (mongoose.connections[0].readyState) {\r\n    console.log(\"MongoDB already connected\");\r\n    return;\r\n  }\r\n\r\n  try {\r\n    await mongoose.connect(process.env.MONGO_URI); \r\n    console.log(\"MongoDB connected successfully\");\r\n  } catch (err) {\r\n    console.error(\"MongoDB connection failed:\", err);\r\n    throw err;\r\n  }\r\n};\r\n\r\nexport default connectionDb;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,eAAe;IACnB,IAAI,oHAAQ,CAAC,WAAW,CAAC,EAAE,CAAC,UAAU,EAAE;QACtC,QAAQ,GAAG,CAAC;QACZ;IACF;IAEA,IAAI;QACF,MAAM,oHAAQ,CAAC,OAAO,CAAC,QAAQ,GAAG,CAAC,SAAS;QAC5C,QAAQ,GAAG,CAAC;IACd,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,MAAM;IACR;AACF;uCAEe"}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///E:/React%20Projects/NEXTJS%20PROJECTS/OZONE/ozone-water-1/models/Order.js"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nconst orderItemSchema = new mongoose.Schema(\r\n  {\r\n    size: {\r\n      type: String,\r\n      required: true,\r\n      trim: true,\r\n    },\r\n    price: {\r\n      type: Number,\r\n      required: true,\r\n      min: 0,\r\n    },\r\n    quantity: {\r\n      type: Number,\r\n      required: true,\r\n      min: 1,\r\n    },\r\n  },\r\n  { _id: false }\r\n);\r\n\r\nconst orderSchema = new mongoose.Schema(\r\n  {\r\n    shopName: {\r\n      type: String,\r\n      required: true,\r\n      trim: true,\r\n    },\r\n\r\n    shopAddress: {\r\n      type: String,\r\n      required: true,\r\n      trim: true,\r\n    },\r\n\r\n    shopContact: {\r\n      type: String,\r\n      required: true,\r\n      trim: true,\r\n    },\r\n\r\n    orderItems: {\r\n      type: [orderItemSchema], // ‚¨Ö MULTIPLE ITEMS HERE\r\n      required: true,\r\n      validate: {\r\n        validator: (items) => items.length > 0,\r\n        message: \"Order must include at least 1 item.\",\r\n      },\r\n    },\r\n\r\n    totalPrice: {\r\n      type: Number,\r\n      required: true,\r\n      min: 0,\r\n    },\r\n\r\n    paymentStatus: {\r\n      type: String,\r\n      enum: [\"unpaid\", \"paid\", \"partially-paid\"],\r\n      default: \"unpaid\",\r\n    },\r\n    paidAmount: {\r\n      type: Number,\r\n      min: 0,\r\n        default: 0,\r\n    },\r\n    isDeleted: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n\r\n    remainingAmount: {\r\n      type: Number,\r\n      min: 0,\r\n      default: 0,\r\n      validate: {\r\n        validator: function (value) {\r\n          if (this.paymentStatus === \"partially-paid\") {\r\n            return value > 0;\r\n          }\r\n          return true;\r\n        },\r\n        message:\r\n          \"Remaining amount must be greater than 0 when status is partially-paid.\",\r\n      },\r\n    },\r\n\r\n    status: {\r\n      type: String,\r\n      enum: [\"pending\", \"in-transit\", \"completed\", \"canceled\"],\r\n      default: \"pending\",\r\n    },\r\n  },\r\n  { timestamps: true }\r\n);\r\n\r\nexport default mongoose.model(\"Order\", orderSchema);\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB,IAAI,oHAAQ,CAAC,MAAM,CACzC;IACE,MAAM;QACJ,MAAM;QACN,UAAU;QACV,MAAM;IACR;IACA,OAAO;QACL,MAAM;QACN,UAAU;QACV,KAAK;IACP;IACA,UAAU;QACR,MAAM;QACN,UAAU;QACV,KAAK;IACP;AACF,GACA;IAAE,KAAK;AAAM;AAGf,MAAM,cAAc,IAAI,oHAAQ,CAAC,MAAM,CACrC;IACE,UAAU;QACR,MAAM;QACN,UAAU;QACV,MAAM;IACR;IAEA,aAAa;QACX,MAAM;QACN,UAAU;QACV,MAAM;IACR;IAEA,aAAa;QACX,MAAM;QACN,UAAU;QACV,MAAM;IACR;IAEA,YAAY;QACV,MAAM;YAAC;SAAgB;QACvB,UAAU;QACV,UAAU;YACR,WAAW,CAAC,QAAU,MAAM,MAAM,GAAG;YACrC,SAAS;QACX;IACF;IAEA,YAAY;QACV,MAAM;QACN,UAAU;QACV,KAAK;IACP;IAEA,eAAe;QACb,MAAM;QACN,MAAM;YAAC;YAAU;YAAQ;SAAiB;QAC1C,SAAS;IACX;IACA,YAAY;QACV,MAAM;QACN,KAAK;QACH,SAAS;IACb;IACA,WAAW;QACT,MAAM;QACN,SAAS;IACX;IAEA,iBAAiB;QACf,MAAM;QACN,KAAK;QACL,SAAS;QACT,UAAU;YACR,WAAW,SAAU,KAAK;gBACxB,IAAI,IAAI,CAAC,aAAa,KAAK,kBAAkB;oBAC3C,OAAO,QAAQ;gBACjB;gBACA,OAAO;YACT;YACA,SACE;QACJ;IACF;IAEA,QAAQ;QACN,MAAM;QACN,MAAM;YAAC;YAAW;YAAc;YAAa;SAAW;QACxD,SAAS;IACX;AACF,GACA;IAAE,YAAY;AAAK;uCAGN,oHAAQ,CAAC,KAAK,CAAC,SAAS"}},
    {"offset": {"line": 272, "column": 0}, "map": {"version":3,"sources":["file:///E:/React%20Projects/NEXTJS%20PROJECTS/OZONE/ozone-water-1/lib/emailService.js"],"sourcesContent":["import nodemailer from \"nodemailer\";\r\n\r\n// Create transporter\r\nconst transporter = nodemailer.createTransport({\r\n  host: process.env.EMAIL_HOST,\r\n  port: parseInt(process.env.EMAIL_PORT),\r\n  secure: false, // true for 465, false for other ports\r\n  auth: {\r\n    user: process.env.EMAIL_USER,\r\n    pass: process.env.EMAIL_PASSWORD,\r\n  },\r\n});\r\n\r\n// Verify transporter configuration\r\ntransporter.verify(function (error, success) {\r\n  if (error) {\r\n    console.log(\"Email transporter error:\", error);\r\n  } else {\r\n    console.log(\"Email server is ready to send messages\");\r\n  }\r\n});\r\n\r\n// Generate order email HTML template\r\nfunction generateOrderEmailHTML(order) {\r\n  const itemsHTML = order.orderItems\r\n    .map(\r\n      (item, index) => `\r\n    <tr style=\"border-bottom: 1px solid #e5e7eb;\">\r\n      <td style=\"padding: 12px; text-align: left;\">${index + 1}</td>\r\n      <td style=\"padding: 12px; text-align: left;\">${item.size}</td>\r\n      <td style=\"padding: 12px; text-align: center;\">${item.quantity}</td>\r\n      <td style=\"padding: 12px; text-align: right;\">Rs.${item.price.toFixed(\r\n        2\r\n      )}</td>\r\n      <td style=\"padding: 12px; text-align: right; font-weight: 600;\">Rs.${(\r\n        item.price * item.quantity\r\n      ).toFixed(2)}</td>\r\n    </tr>\r\n  `\r\n    )\r\n    .join(\"\");\r\n\r\n  return `\r\n    <!DOCTYPE html>\r\n    <html>\r\n    <head>\r\n      <meta charset=\"UTF-8\">\r\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n      <title>New Order Notification</title>\r\n    </head>\r\n    <body style=\"margin: 0; padding: 0; font-family: Arial, sans-serif; background-color: #f3f4f6;\">\r\n      <div style=\"max-width: 600px; margin: 0 auto; background-color: #ffffff;\">\r\n        <!-- Header -->\r\n        <div style=\"background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%); padding: 30px; text-align: center;\">\r\n          <h1 style=\"color: #ffffff; margin: 0; font-size: 28px; font-weight: bold;\">\r\n            üéâ New Order Received!\r\n          </h1>\r\n          <p style=\"color: #dbeafe; margin: 10px 0 0 0; font-size: 14px;\">\r\n            ${process.env.COMPANY_NAME || \"OZONE MINER WATER\"}\r\n          </p>\r\n        </div>\r\n\r\n        <!-- Order Info -->\r\n        <div style=\"padding: 30px;\">\r\n          <div style=\"background-color: #f0f9ff; border-left: 4px solid #3b82f6; padding: 15px; margin-bottom: 20px;\">\r\n            <p style=\"margin: 0; color: #1e40af; font-size: 14px; font-weight: 600;\">ORDER ID</p>\r\n            <p style=\"margin: 5px 0 0 0; color: #1e3a8a; font-size: 16px; font-weight: bold;\">#${\r\n              order._id\r\n            }</p>\r\n          </div>\r\n\r\n          <!-- Customer Details -->\r\n          <h2 style=\"color: #1f2937; font-size: 18px; margin: 25px 0 15px 0; border-bottom: 2px solid #e5e7eb; padding-bottom: 8px;\">\r\n            üìç Customer Details\r\n          </h2>\r\n          <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 25px;\">\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #6b7280; font-weight: 600; width: 140px;\">Shop Name:</td>\r\n              <td style=\"padding: 8px 0; color: #1f2937; font-weight: 600;\">${\r\n                order.shopName\r\n              }</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #6b7280; font-weight: 600;\">Address:</td>\r\n              <td style=\"padding: 8px 0; color: #1f2937;\">${\r\n                order.shopAddress\r\n              }</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #6b7280; font-weight: 600;\">Contact:</td>\r\n              <td style=\"padding: 8px 0; color: #1f2937;\">${\r\n                order.shopContact\r\n              }</td>\r\n            </tr>\r\n          </table>\r\n\r\n          <!-- Order Items -->\r\n          <h2 style=\"color: #1f2937; font-size: 18px; margin: 25px 0 15px 0; border-bottom: 2px solid #e5e7eb; padding-bottom: 8px;\">\r\n            üõí Order Items\r\n          </h2>\r\n          <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 25px; border: 1px solid #e5e7eb;\">\r\n            <thead>\r\n              <tr style=\"background-color: #f9fafb;\">\r\n                <th style=\"padding: 12px; text-align: left; color: #374151; font-weight: 600; border-bottom: 2px solid #e5e7eb;\">#</th>\r\n                <th style=\"padding: 12px; text-align: left; color: #374151; font-weight: 600; border-bottom: 2px solid #e5e7eb;\">Size</th>\r\n                <th style=\"padding: 12px; text-align: center; color: #374151; font-weight: 600; border-bottom: 2px solid #e5e7eb;\">Qty</th>\r\n                <th style=\"padding: 12px; text-align: right; color: #374151; font-weight: 600; border-bottom: 2px solid #e5e7eb;\">Price</th>\r\n                <th style=\"padding: 12px; text-align: right; color: #374151; font-weight: 600; border-bottom: 2px solid #e5e7eb;\">Total</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              ${itemsHTML}\r\n            </tbody>\r\n          </table>\r\n\r\n          <!-- Payment Summary -->\r\n          <div style=\"background-color: #f9fafb; padding: 20px; border-radius: 8px; margin-bottom: 25px;\">\r\n            <table style=\"width: 100%; border-collapse: collapse;\">\r\n              <tr>\r\n                <td style=\"padding: 8px 0; color: #6b7280; font-size: 14px;\">Total Amount:</td>\r\n                <td style=\"padding: 8px 0; color: #1f2937; font-weight: 600; text-align: right; font-size: 16px;\">Rs.${order.totalPrice.toFixed(\r\n                  2\r\n                )}</td>\r\n              </tr>\r\n              <tr>\r\n                <td style=\"padding: 8px 0; color: #6b7280; font-size: 14px;\">Paid Amount:</td>\r\n                <td style=\"padding: 8px 0; color: #059669; font-weight: 600; text-align: right; font-size: 16px;\">Rs.${(\r\n                  order.paidAmount || 0\r\n                ).toFixed(2)}</td>\r\n              </tr>\r\n              <tr>\r\n                <td style=\"padding: 8px 0; color: #6b7280; font-size: 14px;\">Remaining Amount:</td>\r\n                <td style=\"padding: 8px 0; color: #dc2626; font-weight: 600; text-align: right; font-size: 16px;\">Rs.${(\r\n                  order.remainingAmount || 0\r\n                ).toFixed(2)}</td>\r\n              </tr>\r\n              <tr style=\"border-top: 2px solid #e5e7eb;\">\r\n                <td style=\"padding: 12px 0 0 0; color: #374151; font-weight: 600; font-size: 14px;\">Payment Status:</td>\r\n                <td style=\"padding: 12px 0 0 0; text-align: right;\">\r\n                  <span style=\"background-color: ${\r\n                    order.paymentStatus === \"paid\" ? \"#d1fae5\" : \"#fef3c7\"\r\n                  }; color: ${\r\n    order.paymentStatus === \"paid\" ? \"#065f46\" : \"#92400e\"\r\n  }; padding: 6px 12px; border-radius: 12px; font-size: 12px; font-weight: 600; text-transform: uppercase;\">\r\n                    ${order.paymentStatus || \"pending\"}\r\n                  </span>\r\n                </td>\r\n              </tr>\r\n              <tr>\r\n                <td style=\"padding: 8px 0; color: #374151; font-weight: 600; font-size: 14px;\">Order Status:</td>\r\n                <td style=\"padding: 8px 0; text-align: right;\">\r\n                  <span style=\"background-color: #dbeafe; color: #1e40af; padding: 6px 12px; border-radius: 12px; font-size: 12px; font-weight: 600; text-transform: uppercase;\">\r\n                    ${order.status || \"pending\"}\r\n                  </span>\r\n                </td>\r\n              </tr>\r\n            </table>\r\n          </div>\r\n\r\n          <!-- Order Date -->\r\n          <p style=\"color: #6b7280; font-size: 13px; margin: 20px 0 0 0; text-align: center;\">\r\n            Order placed on: ${new Date(\r\n              order.createdAt || Date.now()\r\n            ).toLocaleString(\"en-IN\", {\r\n              dateStyle: \"full\",\r\n              timeStyle: \"short\",\r\n            })}\r\n          </p>\r\n        </div>\r\n\r\n        <!-- Footer -->\r\n        <div style=\"background-color: #f9fafb; padding: 20px; text-align: center; border-top: 1px solid #e5e7eb;\">\r\n          <p style=\"margin: 0 0 10px 0; color: #6b7280; font-size: 14px; font-weight: 600;\">\r\n            ${process.env.COMPANY_NAME || \"OZONE MINER WATER\"}\r\n          </p>\r\n          <p style=\"margin: 0; color: #9ca3af; font-size: 12px;\">\r\n            This is an automated notification. Please do not reply to this email.\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </body>\r\n    </html>\r\n  `;\r\n}\r\n\r\n// Send order notification email to admin\r\nexport async function sendOrderNotificationEmail(order) {\r\n  try {\r\n    const adminEmail = process.env.ADMIN_EMAIL;\r\n\r\n    if (!adminEmail) {\r\n      console.error(\"ADMIN_EMAIL is not configured in environment variables\");\r\n      return { success: false, error: \"Admin email not configured\" };\r\n    }\r\n\r\n    const mailOptions = {\r\n      from: `\"${process.env.COMPANY_NAME || \"OZONE MINER WATER\"}\" <${\r\n        process.env.EMAIL_USER\r\n      }>`,\r\n      to: adminEmail,\r\n      subject: `üîî New Order from ${order.shopName} - Order #${order._id}`,\r\n      html: generateOrderEmailHTML(order),\r\n    };\r\n\r\n    const info = await transporter.sendMail(mailOptions);\r\n    console.log(\"Order notification email sent:\", info.messageId);\r\n\r\n    return { success: true, messageId: info.messageId };\r\n  } catch (error) {\r\n    console.error(\"Error sending order notification email:\", error);\r\n    return { success: false, error: error.message };\r\n  }\r\n}\r\n\r\nexport default transporter;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 466, "column": 0}, "map": {"version":3,"sources":["file:///E:/React%20Projects/NEXTJS%20PROJECTS/OZONE/ozone-water-1/src/app/api/orders/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport connectDB from \"../../../../lib/db\";\r\nimport Order from \"../../../../models/Order\";\r\nimport { sendOrderNotificationEmail } from \"../../../../lib/emailService\";\r\n\r\nexport async function POST(request) {\r\n  try {\r\n    await connectDB();\r\n\r\n    const {\r\n      shopName,\r\n      shopAddress,\r\n      shopContact,\r\n      orderItems,\r\n      paidAmount,\r\n      totalPrice,\r\n      paymentStatus,\r\n      remainingAmount,\r\n      status,\r\n    } = await request.json();\r\n\r\n    if (!shopName || !shopAddress || !shopContact) {\r\n      return NextResponse.json(\r\n        { message: \"Shop details are required\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    if (!Array.isArray(orderItems) || orderItems.length === 0) {\r\n      return NextResponse.json(\r\n        { message: \"Order must contain at least 1 item\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Validate each item\r\n    for (let item of orderItems) {\r\n      if (!item.size || !item.price || !item.quantity) {\r\n        return NextResponse.json(\r\n          { message: \"Each order item must include size, price, and quantity\" },\r\n          { status: 400 }\r\n        );\r\n      }\r\n    }\r\n\r\n    if (totalPrice === undefined) {\r\n      return NextResponse.json(\r\n        { message: \"totalPrice is required\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const newOrder = new Order({\r\n      shopName,\r\n      shopAddress,\r\n      shopContact,\r\n      orderItems,\r\n      totalPrice,\r\n      paidAmount,\r\n      paymentStatus,\r\n      remainingAmount,\r\n      status,\r\n    });\r\n\r\n    await newOrder.save();\r\n\r\n    // Send email notification to admin (non-blocking)\r\n    sendOrderNotificationEmail(newOrder).catch((err) => {\r\n      console.error(\"Failed to send order notification email:\", err);\r\n      // Don't fail the order creation if email fails\r\n    });\r\n\r\n    return NextResponse.json(\r\n      { message: \"Order placed successfully\", order: newOrder },\r\n      { status: 201 }\r\n    );\r\n  } catch (error) {\r\n    console.error(\"Order creation error:\", error);\r\n    return NextResponse.json(\r\n      { message: \"Server error\", error: error.message },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\nexport async function GET(request) {\r\n  try {\r\n    await connectDB();\r\n    const action = request.nextUrl.searchParams.get(\"action\");\r\n    let orders;\r\n    if (action === \"deleted\") {\r\n      orders = await Order.find({ isDeleted: true }).sort({ createdAt: -1 });\r\n    } else {\r\n      orders = await Order.find({ isDeleted: { $ne: true } }).sort({\r\n        createdAt: -1,\r\n      });\r\n    }\r\n    return NextResponse.json(\r\n      { success: true, message: \"Orders fetched successfully\", data: orders },\r\n      { status: 200 }\r\n    );\r\n  } catch (error) {\r\n    console.error(\"Error fetching orders:\", error);\r\n    return NextResponse.json(\r\n      { message: \"Server error\", error: error.message },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\nexport async function PUT(request) {\r\n  try {\r\n    await connectDB();\r\n    const { action, orderId, updateData } = await request.json();\r\n\r\n    if (!orderId) {\r\n      return NextResponse.json(\r\n        { message: \"orderId is required\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    let finalUpdate = {};\r\n\r\n    //  Soft delete\r\n    if (action === \"delete\") {\r\n      finalUpdate.isDeleted = true;\r\n    }\r\n\r\n    //  Normal update\r\n    if (action === \"update\") {\r\n      finalUpdate = updateData;\r\n    }\r\n\r\n    const updatedOrder = await Order.findByIdAndUpdate(\r\n      orderId,\r\n      { $set: finalUpdate },\r\n      { new: true }\r\n    );\r\n\r\n    if (!updatedOrder) {\r\n      return NextResponse.json({ message: \"Order not found\" }, { status: 404 });\r\n    }\r\n\r\n    return NextResponse.json(\r\n      { success: true, message: \"Order updated\", order: updatedOrder },\r\n      { status: 200 }\r\n    );\r\n  } catch (error) {\r\n    return NextResponse.json(\r\n      { success: false, message: \"Server error\", error: error.message },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}}]
}